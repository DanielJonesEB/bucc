- type: replace
  path: /resource_pools/name=vms/cloud_properties/PortBindings?
  value:
    6868/tcp: [{ HostPort: "6868", HostIp: "0.0.0.0" }] # bosh agent
    443/tcp: [{ HostPort: "443", HostIp: "0.0.0.0" }] # concourse
    8844/tcp: [{ HostPort: "8844", HostIp: "0.0.0.0" }] # credhub
    8200/tcp: [{ HostPort: "8200", HostIp: "0.0.0.0" }] # vault
    8443/tcp: [{ HostPort: "8443", HostIp: "0.0.0.0" }] # uaa
    25555/tcp: [{ HostPort: "25555", HostIp: "0.0.0.0" }] # director
    22/tcp: [{ HostPort: "22", HostIp: "0.0.0.0" }] # ssh

# disable ipv6 so agent port forwarding works
# when enabled curl -k -I https://localhost:6868/agent results in
# empty response
- type: replace
  path: /resource_pools/name=vms/env/bosh/ipv6?/enable
  value: false

- type: replace
  path: /instance_groups/name=bosh/networks/name=default/static_ips
  value: [((static_ip))]

- type: replace
  path: /variables/name=mbus_bootstrap_ssl/options/alternative_names/-
  value: ((static_ip))

- type: replace
  path: /variables/name=director_ssl/options/alternative_names/-
  value: ((static_ip))

- type: replace
  path: /variables/name=director_ssl/options/alternative_names/-
  value: ((static_ip))

- type: replace
  path: /variables/name=credhub_tls/options/alternative_names/-
  value: ((static_ip))

- type: replace
  path: /variables/name=uaa_ssl/options/alternative_names/-
  value: ((static_ip))

- type: replace
  path: /variables/name=atc_ssl/options/alternative_names/-
  value: ((static_ip))

- type: replace
  path: /variables/name=vault-proxy_tls/options/alternative_names/-
  value: ((static_ip))

- type: replace
  path: /instance_groups/name=bosh/jobs/name=vault-credhub-proxy/properties/address
  value: 0.0.0.0:8200

- type: replace
  path: /instance_groups/name=bosh/jobs/name=credhub-importer/properties/credhub/import_credentials/name=concourse~1main~1bosh_environment/value
  value: ((static_ip))

- type: replace
  path: /instance_groups/name=bosh/jobs/name=credhub-importer/properties/credhub/import_credentials/name=concourse~1main~1credhub_url/value
  value: https://((static_ip)):8844

- type: replace
  path: /instance_groups/name=bosh/jobs/name=credhub-importer/properties/credhub/import_credentials/name=concourse~1main~1vault_url/value
  value: https://((static_ip)):8200

- type: replace
  path: /instance_groups/name=bosh/jobs/name=credhub-importer/properties/credhub/import_credentials/name=concourse~1main~1concourse_url/value
  value: https://((static_ip))

- type: replace
  path: /instance_groups/name=bosh/jobs/name=credhub-importer/properties/credhub/import_credentials/name=concourse~1main~1concourse_tsa_host/value
  value: ((static_ip))

- type: replace
  path: /instance_groups/name=bosh/jobs/name=credhub-importer/properties/credhub/import_credentials/name=concourse~1main~1uaa_url/value
  value: https://((static_ip)):8443
